<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Chatroom with Firebase</title>
    <style>
        #chat-container {
            max-height: 300px;
            overflow-y: scroll;
            border: 1px solid #ccc;
            padding: 10px;
        }

        #message-container {
            margin-top: 10px;
        }

        #message {
            width: 70%;
        }

        #username, #message {
            padding: 5px;
            margin-right: 5px;
        }

        #sendBtn {
            padding: 5px 10px;
        }
    </style>
</head>
<body>
    <div>
        <label for="username">Your Name:</label>
        <input type="text" id="username">
        <button onclick="joinChat()">Join Chat</button>
    </div>

    <div id="chat-container"></div>

    <div id="message-container">
        <label for="message">Message:</label>
        <input type="text" id="message">
        <button id="sendBtn" onclick="sendMessage()">Send</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
        // Initialize Firebase with your configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDo9xLGYs3rzhgJKV_qVEyNxCUaRratbXc",
            authDomain: "https://chat-linos-default-rtdb.firebaseio.com/",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);

        const database = firebase.database();
        let username = "";

        function joinChat() {
            const inputUsername = document.getElementById("username");
            if (inputUsername.value.trim() === "") {
                alert("Please enter your name.");
                return;
            }

            username = inputUsername.value;
            inputUsername.disabled = true;

            appendMessage("System", `${username} joined the chat.`);

            // Save the join event to the Firebase database
            database.ref('messages').push({
                sender: 'System',
                message: `${username} joined the chat.`,
            });
        }

        function sendMessage() {
            if (!username) {
                alert("Please join the chat first.");
                return;
            }

            const inputMessage = document.getElementById("message");
            const message = inputMessage.value.trim();

            if (message === "") {
                alert("Please enter a message.");
                return;
            }

            // Save the message to the Firebase database
            database.ref('messages').push({
                sender: username,
                message: message,
            });

            inputMessage.value = "";
        }

        function appendMessage(sender, message) {
            const chatContainer = document.getElementById("chat-container");
            const messageElement = document.createElement("p");
            messageElement.textContent = `[${sender}]: ${message}`;
            chatContainer.appendChild(messageElement);

            // Scroll to the bottom of the chat container
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Listen for new messages in real-time
        database.ref('messages').on('child_added', snapshot => {
            const data = snapshot.val();
            appendMessage(data.sender, data.message);
        });
    </script>
</body>
</html>